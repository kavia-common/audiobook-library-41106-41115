{"is_source_file": true, "format": "Dart", "description": "This file defines the AppState class which manages the state of an audiobook player application. It handles loading persisted data, controlling playback via the just_audio package, tracking progress, managing the catalog and purchased audiobooks, and notifying listeners of state changes.", "external_files": ["../data/mock_catalog.dart", "../models/audiobook.dart", "../services/local_storage_service.dart"], "external_methods": ["LocalStorageService.loadPurchasedIds", "LocalStorageService.loadPlaybackPositions", "LocalStorageService.savePurchasedIds", "LocalStorageService.savePlaybackPositions"], "published": ["isInitializing", "catalog", "library", "isPurchased", "current", "positionMs", "durationMs", "isPlaying", "playbackError", "purchase", "selectAndPrepare", "togglePlayPause", "seekMs", "skipBack15s", "skipForward15s"], "classes": [{"name": "AppState", "description": "A ChangeNotifier managing audiobook playback state, including catalog, purchase status, current playback info, and persistence."}], "methods": [{"name": "init", "description": "Initializes the app state by loading persisted data and setting up audio listeners."}, {"name": "_wirePlayerListeners", "description": "Configures listeners for audio duration, position, player state, and periodic persistence."}, {"name": "purchase", "description": "Adds an audiobook to the purchased list and saves to local storage."}, {"name": "selectAndPrepare", "description": "Sets the current audiobook, loads its audio asset, restores position, and handles errors."}, {"name": "togglePlayPause", "description": "Toggles between playing and pausing the current audiobook."}, {"name": "seekMs", "description": "Seeks to a specific position in milliseconds within the current audiobook."}, {"name": "skipBack15s", "description": "Skips backward 15 seconds in the current audiobook."}, {"name": "skipForward15s", "description": "Skips forward 15 seconds in the current audiobook."}, {"name": "_persistCurrentPosition", "description": "Saves the current playback position to local storage."}], "calls": ["LocalStorageService.loadPurchasedIds", "LocalStorageService.loadPlaybackPositions", "LocalStorageService.savePurchasedIds", "LocalStorageService.savePlaybackPositions", "_player.setAsset", "_player.seek", "_player.play", "_player.pause", "_player.dispose"], "search-terms": ["AudioPlayer", "purchase", "selectAndPrepare", "AudioBook", "app state", "local storage", "playback position", "player listeners"], "state": 2, "file_id": 25, "knowledge_revision": 59, "git_revision": "", "hash": "f370896d74b071baffa53b7cd6de7d2a", "format-version": 4, "code-base-name": "audiobook_store_frontend", "filename": "audiobook_store_frontend/lib/src/state/app_state.dart", "revision_history": [{"59": ""}]}